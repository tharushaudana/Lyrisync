import pygame
import time

# Function to convert timestamp to seconds (handles the milliseconds part)
def timestamp_to_seconds(timestamp):
    minutes, seconds = timestamp.split(":")
    seconds, milliseconds = seconds.split(".")
    return int(minutes) * 60 + int(seconds) + int(milliseconds) / 1000

# Word timestamps and text
word_timestamps_and_text = [
    ("00:19.501", "සරාගියි"),
    ("00:19.941", "දෙනෙත්"),
    ("00:20.241", "බර"),
    ("00:20.481", "වූ"),
    ("00:20.981", "නොහඳුනන"),
    ("00:21.641", "මින්දද"),
    ("00:22.041", "රූ"),
    ("00:22.481", "උන්මාදිනී"),
    ("00:24.421", "සල්ලාල"),
    ("00:24.881", "රජුන්"),
    ("00:25.281", "පවා"),
    ("00:26.201", "ඇගේ"),
    ("00:26.481", "නෙතු"),
    ("00:26.781", "හමුවුණු"),
    ("00:27.181", "දා"),
    ("00:27.381", "මුලාවිණි"),
    ("00:29.421", "පිරුණු"),
    ("00:29.781", "වදන්"),
    ("00:30.141", "මතකින්"),
    ("00:32.001", "නැගෙයි"),
    ("00:32.341", "ඒ"),
    ("00:32.481", "දෙතොල්"),
    ("00:32.881", "අතරින්"),
    ("00:33.401", "නුරා"),
    ("00:33.681", "ගිනි"),
    ("00:35.261", "නොසන්සිඳෙනා"),
    ("00:36.021", "පවසින්"),
    ("00:36.481", "සිටියි"),
    ("00:37.281", "මා"),
    ("00:37.441", "දෙපා"),
    ("00:37.781", "අසල"),
    ("00:38.121", "දණින්"),
    ("00:38.541", "කාමිණී"),
    ("00:39.481", "සරාගියි"),
    ("00:39.881", "දෙනෙත්"),
    ("00:40.181", "බර"),
    ("00:40.421", "වූ"),
    ("00:40.921", "නොහඳුනන"),
    ("00:41.561", "මින්දද"),
    ("00:41.941", "රූ"),
    ("00:42.381", "උන්මාදිනී"),
    ("00:44.301", "සල්ලාල"),
    ("00:44.741", "රජුන්"),
    ("00:45.141", "පවා"),
    ("00:46.061", "ඇගේ"),
    ("00:46.341", "නෙතු"),
    ("00:46.641", "හමුවුණු"),
    ("00:47.041", "දා"),
    ("00:47.241", "මුලාවිණි"),
    ("00:49.201", "පිරුණු"),
    ("00:49.561", "වදන්"),
    ("00:49.921", "මතකින්"),
    ("00:51.081", "නැගෙයි"),
    ("00:51.421", "ඒ"),
    ("00:51.561", "දෙතොල්"),
    ("00:51.961", "අතරින්"),
    ("00:52.481", "නුරා"),
    ("00:52.761", "ගිනි"),
    ("00:54.381", "නොසන්සිඳෙනා"),
    ("00:55.141", "පවසින්"),
    ("00:55.601", "සිටියි"),
    ("00:56.401", "මා"),
    ("00:56.561", "දෙපා"),
    ("00:56.901", "අසල"),
    ("00:57.241", "දණින්"),
    ("00:57.661", "කාමිණී"),
    ("00:59.341", "හඳ"),
    ("00:59.581", "නෑ"),
    ("01:00.321", "කළුවරයි"),
    ("01:00.881", "රාත්රිය"),
    ("01:02.221", "ඈ"),
    ("01:02.341", "මගේ"),
    ("01:02.581", "ළඟින්"),
    ("01:02.881", "ඉඳන්"),
    ("01:03.181", "නිවනවා"),
    ("01:03.641", "මගෙ"),
    ("01:03.881", "කාන්සිය"),
    ("01:04.781", "ගෙවෙනවා"),
    ("01:05.281", "විනාඩියෙන්"),
    ("01:05.881", "විනාඩිය"),
    ("01:07.181", "කතාවේ"),
    ("01:07.541", "තව"),
    ("01:07.741", "කොටසක්"),
    ("01:08.181", "නිමා"),
    ("01:08.481", "විය"),
    ("01:09.381", "දෙවියෝ"),
    ("01:09.741", "ඇති"),
    ("01:09.921", "තරම්"),
    ("01:10.261", "කල්"),
    ("01:10.461", "අරන්"),
    ("01:10.781", "අඹන්න"),
    ("01:11.281", "ඇගේ"),
    ("01:11.521", "රූපේ"),
    ("01:12.341", "ඇඳුනොත්"),
    ("01:12.741", "හිතේ"),
    ("01:12.981", "එක්"),
    ("01:13.141", "වරක්"),
    ("01:13.481", "මැකෙන්නෑ"),
    ("01:13.981", "පින්තූරේ"),
    ("01:14.881", "කවදාවත්"),
    ("01:15.281", "අහන්නෑ"),
    ("01:15.641", "මගෙන්"),
    ("01:15.981", "ඇයි"),
    ("01:16.181", "පමා"),
    ("01:16.501", "වූයේ"),
    ("01:17.281", "මං"),
    ("01:17.441", "පමා"),
    ("01:17.741", "කල"),
    ("01:17.941", "තරමට"),
    ("01:18.381", "ආසාව"),
    ("01:18.781", "වැඩියි"),
    ("01:19.101", "මූණේ"),
    ("01:19.981", "ඈ"),
    ("01:20.101", "මන්දෝදරී"),
    ("01:21.001", "මං"),
    ("01:21.181", "රාවණා"),
    ("01:22.081", "ඈ"),
    ("01:22.201", "කාමිණී"),
    ("01:22.901", "මමයි"),
    ("01:23.221", "වත්ස්යායණ"),
    ("01:24.281", "වෙනසක්"),
    ("01:24.641", "නෑ"),
    ("01:24.781", "මධ්යම"),
    ("01:25.141", "රාත්රී"),
    ("01:26.001", "මධ්යහන"),
    ("01:27.081", "මේ"),
    ("01:27.221", "හෝරාවයි"),
    ("01:27.781", "සංවාස"),
    ("01:28.341", "අධ්යාපන"),
    ("01:29.881", "කාලගුණේ"),
    ("01:30.481", "සීතලයි"),
    ("01:31.781", "අපි"),
    ("01:31.921", "දෙන්නයි"),
    ("01:32.321", "මීදුමයි"),
    ("01:33.081", "එක"),
    ("01:33.241", "පාර"),
    ("01:33.481", "ඇවිත්"),
    ("01:33.841", "ගිම්හානෙයි"),
    ("01:34.481", "ශීත"),
    ("01:34.741", "සෘතුවයි"),
    ("01:35.581", "උෂ්ණත්වමාපකේ"),
    ("01:36.481", "අංශක"),
    ("01:36.841", "බිංදුවයි"),
    ("01:37.741", "රතු"),
    ("01:37.961", "වෙලා"),
    ("01:38.201", "වගෙයි"),
    ("01:38.521", "ඈ"),
    ("01:38.641", "පුපුරන්න"),
    ("01:39.201", "මිනිත්තුවයි"),
    ("01:40.181", "තව"),
    ("01:40.361", "මදියි"),
    ("01:40.701", "ඇගේ"),
    ("01:40.961", "කාමුක"),
    ("01:41.381", "දෑස්"),
    ("01:41.681", "අයදී"),
    ("01:42.581", "ඈ"),
    ("01:42.701", "ළඟදි"),
    ("01:43.021", "රති"),
    ("01:43.281", "මාර"),
    ("01:43.601", "දූත්"),
    ("01:43.881", "පරදියි"),
    ("01:45.121", "ඈ"),
    ("01:45.241", "කොඳුරයි"),
    ("01:45.721", "මගේ"),
    ("01:45.941", "කණට"),
    ("01:46.521", "උරහිසට"),
    ("01:46.981", "බර"),
    ("01:47.201", "වී"),
    ("01:47.781", "මා"),
    ("01:47.941", "සනසන්න"),
    ("01:48.481", "හැකි"),
    ("01:48.741", "නුඹට"),
    ("01:49.101", "ප"),
    ("01:49.221", "ම"),
    ("01:49.381", "ණී"),
    ("01:50.421", "සරාගියි"),
    ("01:50.861", "දෙනෙත්"),
    ("01:51.161", "බර"),
    ("01:51.401", "වූ"),
    ("01:51.881", "නොහඳුනන"),
    ("01:52.541", "මින්දද"),
    ("01:52.921", "රූ"),
    ("01:53.361", "උන්මාදිනී"),
    ("01:55.281", "සල්ලාල"),
    ("01:55.721", "රජුන්"),
    ("01:56.121", "පවා"),
    ("01:57.041", "ඇගේ"),
    ("01:57.321", "නෙතු"),
    ("01:57.621", "හමුවුණු"),
    ("01:58.021", "දා"),
    ("01:58.221", "මුලාවිණි"),
    ("02:00.161", "පිරුණු"),
    ("02:00.521", "වදන්"),
    ("02:00.881", "මතකින්"),
    ("02:02.041", "නැගෙයි"),
    ("02:02.381", "ඒ"),
    ("02:02.521", "දෙතොල්"),
    ("02:02.921", "අතරින්"),
    ("02:03.441", "නුරා"),
    ("02:03.721", "ගිනි"),
    ("02:05.341", "නොසන්සිඳෙනා"),
    ("02:06.101", "පවසින්"),
    ("02:06.561", "සිටියි"),
    ("02:07.361", "මා"),
    ("02:07.521", "දෙපා"),
    ("02:07.861", "අසල"),
    ("02:08.201", "දණින්"),
    ("02:08.621", "කාමිණී"),
    ("02:10.541", "සරාගියි"),
    ("02:10.981", "දෙනෙත්"),
    ("02:11.281", "බර"),
    ("02:11.521", "වූ"),
    ("02:12.021", "නොහඳුනන"),
    ("02:12.661", "මින්දද"),
    ("02:13.041", "රූ"),
    ("02:13.481", "උන්මාදිනී"),
    ("02:15.401", "සල්ලාල"),
    ("02:15.841", "රජුන්"),
    ("02:16.241", "පවා"),
    ("02:17.161", "ඇගේ"),
    ("02:17.441", "නෙතු"),
    ("02:17.741", "හමුවුණු"),
    ("02:18.141", "දා"),
    ("02:18.341", "මුලාවිණි"),
    ("02:20.281", "පිරුණු"),
    ("02:20.641", "වදන්"),
    ("02:21.001", "මතකින්"),
    ("02:22.161", "නැගෙයි"),
    ("02:22.501", "ඒ"),
    ("02:22.641", "දෙතොල්"),
    ("02:23.041", "අතරින්"),
    ("02:23.561", "නුරා"),
    ("02:23.841", "ගිනි"),
    ("02:25.461", "නොසන්සිඳෙනා"),
    ("02:26.221", "පවසින්"),
    ("02:26.681", "සිටියි"),
    ("02:27.481", "මා"),
    ("02:27.641", "දෙපා"),
    ("02:27.981", "අසල"),
    ("02:28.321", "දණින්"),
    ("02:28.741", "කාමිණී"),
    ("02:30.241", "ඈ"),
    ("02:30.381", "හිස්"),
    ("02:30.621", "අවකාශයක්"),
    ("02:31.281", "වූ"),
    ("02:31.441", "නිසල"),
    ("02:31.801", "රැයකි"),
    ("02:33.001", "දිව්යාංගනාවක්"),
    ("02:33.781", "ඈ"),
    ("02:33.901", "සුරලොවින්"),
    ("02:34.481", "පැමිණි"),
    ("02:36.001", "මා"),
    ("02:36.161", "ලෝ"),
    ("02:36.361", "අන්ධකාරේ"),
    ("02:37.181", "ඒ"),
    ("02:37.301", "ආලෝකෙන්"),
    ("02:37.781", "යයි"),
    ("02:37.941", "නැතිවී"),
    ("02:38.681", "මන්"),
    ("02:38.881", "මත්"),
    ("02:39.141", "කරයි"),
    ("02:39.461", "ඈ"),
    ("02:39.601", "මා"),
    ("02:39.781", "තුරුලට"),
    ("02:40.241", "දැවටී"),
    ("02:41.081", "අවුලයි"),
    ("02:41.481", "මා"),
    ("02:41.641", "සිත"),
    ("02:41.861", "ඇගෙ"),
    ("02:42.101", "කොඳුරන"),
    ("02:42.601", "මුවඟින්"),
    ("02:43.481", "ආශා"),
    ("02:43.801", "දහසක්"),
    ("02:44.221", "වපුරයි"),
    ("02:44.641", "ඇගේ"),
    ("02:44.881", "සුවඳින්"),
    ("02:45.681", "සම"),
    ("02:45.881", "කරන්නද"),
    ("02:46.341", "නුඹේ"),
    ("02:46.581", "දෙනෙත්"),
    ("02:46.941", "මම"),
    ("02:47.101", "කුමකින්"),
    ("02:48.101", "එනු"),
    ("02:48.321", "මැන"),
    ("02:48.561", "තුරුලට"),
    ("02:49.141", "ඉන්න"),
    ("02:49.381", "එපා"),
    ("02:49.621", "දුරකින්"),
    ("02:51.081", "පුරඟනී"),
    ("02:51.681", "ඈ"),
    ("02:51.801", "මා"),
    ("02:51.981", "ගාව"),
    ("02:52.241", "දැවටී"),
    ("02:53.081", "මා"),
    ("02:53.241", "යහනේ"),
    ("02:53.621", "වැතිරී"),
    ("02:54.401", "නිරුවතින්"),
    ("02:54.901", "හැඩ"),
    ("02:55.121", "වී"),
    ("02:55.781", "මුමුණාවී"),
    ("02:56.281", "මතකින්"),
    ("02:57.081", "මමයි"),
    ("02:57.341", "නුඹේ"),
    ("02:57.601", "රැජිණී"),
    ("02:58.381", "රජුනී"),
    ("02:58.781", "නුඹ"),
    ("02:58.981", "කැමති"),
    ("02:59.361", "දේ"),
    ("02:59.521", "කළ"),
    ("02:59.741", "මැනවී"),
    ("03:01.141", "තෙත්"),
    ("03:01.381", "කරන්නම්"),
    ("03:01.881", "මං"),
    ("03:02.041", "නුඹ"),
    ("03:02.241", "වැස්සක්"),
    ("03:02.661", "වගේ"),
    ("03:03.381", "මතු"),
    ("03:03.621", "කරයි"),
    ("03:03.921", "නුඹ"),
    ("03:04.121", "නොදැකපු"),
    ("03:04.601", "පැත්තක්"),
    ("03:05.021", "මගේ"),
    ("03:05.881", "රාගය"),
    ("03:06.281", "ඇත"),
    ("03:06.601", "ආලය"),
    ("03:06.961", "නැතත්"),
    ("03:07.341", "හදේ"),
    ("03:08.421", "ආත්මයන්"),
    ("03:09.001", "ගැටී"),
    ("03:09.321", "නොතේරෙයි"),
    ("03:09.881", "ඇත්තක්ද"),
    ("03:10.341", "මේ"),
    ("03:11.381", "සරාගියි"),
    ("03:11.821", "දෙනෙත්"),
    ("03:12.121", "බර"),
    ("03:12.361", "වූ"),
    ("03:12.861", "නොහඳුනන"),
    ("03:13.501", "මින්දද"),
    ("03:13.881", "රූ"),
    ("03:14.321", "උන්මාදිනී"),
    ("03:16.241", "සල්ලාල"),
    ("03:16.681", "රජුන්"),
    ("03:17.081", "පවා"),
    ("03:18.001", "ඇගේ"),
    ("03:18.281", "නෙතු"),
    ("03:18.581", "හමුවුණු"),
    ("03:18.981", "දා"),
    ("03:19.181", "මුලාවිණි"),
    ("03:21.121", "පිරුණු"),
    ("03:21.481", "වදන්"),
    ("03:21.841", "මතකින්"),
    ("03:23.001", "නැගෙයි"),
    ("03:23.341", "ඒ"),
    ("03:23.481", "දෙතොල්"),
    ("03:23.881", "අතරින්"),
    ("03:24.401", "නුරා"),
    ("03:24.681", "ගිනි"),
    ("03:26.301", "නොසන්සිඳෙනා"),
    ("03:27.061", "පවසින්"),
    ("03:27.521", "සිටියි"),
    ("03:28.321", "මා"),
    ("03:28.481", "දෙපා"),
    ("03:28.821", "අසල"),
    ("03:29.161", "දණින්"),
    ("03:29.581", "කාමිණී"),
    ("03:31.281", "සරාගියි"),
    ("03:31.721", "දෙනෙත්"),
    ("03:32.021", "බර"),
    ("03:32.261", "වූ"),
    ("03:32.761", "නොහඳුනන"),
    ("03:33.401", "මින්දද"),
    ("03:33.781", "රූ"),
    ("03:34.221", "උන්මාදිනී"),
    ("03:36.141", "සල්ලාල"),
    ("03:36.581", "රජුන්"),
    ("03:36.981", "පවා"),
    ("03:37.901", "ඇගේ"),
    ("03:38.181", "නෙතු"),
    ("03:38.481", "හමුවුණු"),
    ("03:38.881", "දා"),
    ("03:39.081", "මුලාවිණි"),
    ("03:41.021", "පිරුණු"),
    ("03:41.381", "වදන්"),
    ("03:41.741", "මතකින්"),
    ("03:42.901", "නැගෙයි"),
    ("03:43.241", "ඒ"),
    ("03:43.381", "දෙතොල්"),
    ("03:43.781", "අතරින්"),
    ("03:44.301", "නුරා"),
    ("03:44.581", "ගිනි"),
    ("03:46.201", "නොසන්සිඳෙනා"),
    ("03:46.961", "පවසින්"),
    ("03:47.421", "සිටියි"),
    ("03:48.221", "මා"),
    ("03:48.381", "දෙපා"),
    ("03:48.721", "අසල"),
    ("03:49.061", "දණින්"),
    ("03:49.481", "කාමිණී"),
    ("03:51.181", "හිස්"),
    ("03:51.401", "අවකාශයෙන්"),
    ("03:52.081", "මතුවෙන්න"),
    ("03:52.541", "සැණින්"),
    ("03:53.341", "ඇස්බැන්දුමක්"),
    ("03:53.981", "වගේ"),
    ("03:54.241", "මට"),
    ("03:54.401", "හිතාගන්න"),
    ("03:54.941", "බැරි"),
    ("03:56.101", "ඒ"),
    ("03:56.221", "කාමිණී"),
    ("03:56.721", "මං"),
    ("03:56.881", "ළඟ"),
    ("03:57.101", "වැටී"),
    ("03:57.401", "දණින්"),
    ("03:58.401", "එළිවෙනකන්"),
    ("03:58.981", "යාඥා"),
    ("03:59.381", "කරලා"),
    ("03:59.741", "රතු"),
    ("03:59.961", "වෙලා"),
    ("04:00.241", "ඇගේ"),
    ("04:00.481", "දණිස්")
]

# Initialize pygame
pygame.init()

# Set up the display window
window_size = (800, 600)
screen = pygame.display.set_mode(window_size)
pygame.display.set_caption("Audio Word Visualization")

# Define colors
WHITE = (255, 255, 255)
BLACK = (0, 0, 0)

# Load the audio file
pygame.mixer.init()
pygame.mixer.music.load("kamini.mp3")

# Function to render text with an animation effect
def render_text(text, position, alpha):
    font = pygame.font.Font("Noto_Sans_Sinhala/NotoSansSinhala-VariableFont_wdth,wght.ttf", 48)
    text_surface = font.render(text, True, WHITE)
    text_surface.set_alpha(alpha)  # Set transparency for the effect
    screen.blit(text_surface, position)

# Start the audio
pygame.mixer.music.play()

# Start timing
start_time = time.time()

# Main loop to run the visualization
running = True
current_word_index = 0
while running:
    screen.fill(BLACK)  # Clear screen
    
    # Get current playback time of the audio
    current_time = time.time() - start_time
    current_time_str = "{:02}:{:02}.{:03}".format(int(current_time // 60), int(current_time % 60), int((current_time % 1) * 1000))

    # Check if any word should be displayed
    if current_word_index < len(word_timestamps_and_text):
        timestamp, text = word_timestamps_and_text[current_word_index]
        if current_time_str >= timestamp:
            current_word_index += 1
            # Render the word with animation (e.g., fade-in)
            render_text(text, (400 - len(text) * 10, 300), alpha=255)
    
    # Update the screen
    pygame.display.update()

    # Event handling
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False

    time.sleep(0.01)  # Delay to reduce CPU usage

# Quit pygame
pygame.quit()
